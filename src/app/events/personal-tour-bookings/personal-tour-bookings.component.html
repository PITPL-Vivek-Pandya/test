<div class="row" *ngIf="personalTour">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header card-header-icon card-header-primary">
                <div class="card-icon">
                    <i class="material-icons-outlined">inventory</i>
                </div>
                <h4 class="card-title">{{title}}</h4>
            </div>
            <div class="card-body">
                <div class="toolbar">
                    <!--        Here you can write extra buttons/actions for the toolbar              -->
                </div>

                <div class="row">
                    <div class="col-sm-8"></div>
                    <div class="col-sm-4">
                        <div class="float-right mx-2">
                            <mat-form-field>
                                <input matInput [disabled]="!dataSource" [value]="tableState.searchText"
                                    (keyup)="applyFilter($event.target.value)" placeholder="Search results">
                            </mat-form-field>
                        </div>
                    </div>
                </div>

                <div class="table-responsive">
                    <table mat-table [id]="tableId" [dataSource]="dataSource" matSort
                        (matSortChange)="onSortChange($event)" matSortActive="date" matSortDirection="desc">

                        <!-- contacts Column -->
                        <ng-container matColumnDef="contacts">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Contact(s)</th>
                            <td mat-cell *matCellDef="let element">
                                <ng-container *ngFor="let contact of element.contacts; let i = index">
                                    {{contact.name}}{{(i < element.contacts.length-1) ? ' ' : '' }}<br />
                                </ng-container>
                            </td>
                        </ng-container>

                        <!-- students Column -->
                        <ng-container matColumnDef="students">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Student(s)</th>
                            <td mat-cell *matCellDef="let element">
                                <ng-container *ngFor="let student of element.students; let i = index">
                                    {{student.name}} {{(i < element.students.length-1) ? ' ' : '' }}<br />
                                </ng-container>
                            </td>
                        </ng-container>

                        <!-- totalRSVP Column -->
                        <ng-container matColumnDef="totalRSVP">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Total RSVP</th>
                            <td mat-cell *matCellDef="let element">{{element.totalRSVP}}</td>
                        </ng-container>

                        <!-- checkedIn Column -->
                        <ng-container matColumnDef="checkedIn">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Checked In</th>
                            <td mat-cell *matCellDef="let element">{{element.checkedIn}}</td>
                        </ng-container>

                        <!-- totalcheckedIn Column -->
                        <ng-container matColumnDef="totalcheckedIn">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Checked In</th>
                            <td mat-cell *matCellDef="let element">{{element.totalcheckedIn}}</td>
                        </ng-container>

                        <!-- conduct Column -->
                        <ng-container matColumnDef="conduct">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Code of Conduct Agreed</th>
                            <td mat-cell *matCellDef="let element">{{element.conduct}}</td>
                        </ng-container>

                        <!-- Actions Column -->
                        <ng-container matColumnDef="actions">
                            <th mat-header-cell *matHeaderCellDef> <span class="float-right">Actions</span></th>
                            <td class="td-actions text-right" mat-cell *matCellDef="let element">
                                <button mat-raised-button type="button" class="btn btn-info btn-link"
                                    matTooltip="CheckIn/CheckOut" matTooltipPosition="left"
                                    (click)="checkInBooking(element)">
                                    <i class="material-icons"
                                        *ngIf="element.checkedInCount === 0">check_box_outline_blank</i>
                                    <i class="material-icons"
                                        *ngIf="element.checkedInCount === element.totalAttendees && element.checkedInCount !== 0">check_box</i>
                                    <i class="material-icons"
                                        *ngIf="(element.totalAttendees > element.checkedInCount && element.checkedInCount > 0) ||
                                        (element.totalAttendees < element.checkedInCount) && element.checkedInCount > 0">indeterminate_check_box</i>
                                </button>
                                <button mat-raised-button type="button" class="btn btn-success btn-link"
                                    matTooltip="Edit" matTooltipPosition="left" (click)="editBookingModal(element)">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button mat-raised-button type="button" class="btn btn-danger btn-link"
                                    matTooltip="Remove" matTooltipPosition="left"
                                    *ngIf="!userInfo.isSchoolRepresentative()" (click)="deleteBooking(element)">
                                    <i class="material-icons">close</i>
                                </button>
                            </td>
                        </ng-container>

                        <!-- No Data -->
                        <ng-container matColumnDef="noData">
                            <td [hidden]="!dataSource || (dataSource && dataSource.filteredData && dataSource.filteredData.length > 0)"
                                mat-footer-cell *matFooterCellDef colspan="7">
                                {{noDataInTable}}
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        <tr mat-footer-row *matFooterRowDef="['noData']" class="text-center"></tr> <!-- No Data-->

                    </table>
                </div>

                <mat-paginator (page)="onPaginatorChange($event)"></mat-paginator>

                <div class="text-right">
                    <button class="btn btn-primary" type="button" (click)="addAnAttendee()">
                        <i class="material-icons">playlist_add</i>REGISTER ATTENDEES
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
